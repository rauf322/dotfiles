# Personal Tmux Configuration
# Clean, organized tmux setup with UI and keybindings

# -- Prefix and Basic Settings ----------------------------------------------------
set -g prefix C-a
unbind C-b
bind-key C-a send-prefix

# -- Display and UI Settings --------------------------------------------------
set-option -g mouse on
set -g base-index 1                    # start windows numbering at 1
setw -g pane-base-index 1              # make pane numbering consistent with windows
setw -g automatic-rename on            # rename window to reflect current program
set -g renumber-windows on             # renumber windows when a window is closed
set -g set-titles on                   # set terminal title
set -g display-panes-time 800          # slightly longer pane indicators display time
set -g display-time 1000               # slightly longer status messages display time
set -g status-interval 10              # redraw status line every 10 seconds
set -g history-limit 5000              # boost history
set -g detach-on-destroy off           # don't exit from tmux when closing a session
set -g set-clipboard on                # use system clipboard
set -g status-position bottom          # macOS / darwin style
set -g allow-passthrough on
set -ga update-environment TERM
set -ga update-environment TERM_PROGRAM

# UTF-8 support
set -q -g status-utf8 on
setw -q -g utf8 on

# -- Keybindings --------------------------------------------------------------

# Session management
bind-key K kill-session               # Kill session
bind C-c new-session                  # Create new session
bind c new-window                     # Create new window

# Pane navigation (vim-like)
bind h select-pane -L              # move left
bind j select-pane -D              # move down  
bind k select-pane -U              # move up
bind l select-pane -R              # move right

# Pane splitting
unbind %
bind | split-window -h                # Split horizontally
unbind '"'
bind - split-window -v                # Split vertically

# Pane resizing
bind -r , resize-pane -L 15     # Resize left (comma)
bind -r . resize-pane -R 15     # Resize right (period)
bind -r < resize-pane -U 15     # Resize up
bind -r > resize-pane -D 15    # Resize down

# Pane switcher from left to right
bind -r H swap-pane -U  
bind -r L swap-pane -D

# Window management
bind -r R command-prompt "rename-window %%"  # Rename window
bind -r x kill-pane                      # Kill pane
bind -r f resize-pane -Z                 # Toggle pane zoom
# Toggle opencode
bind -r p run-shell "tmux-open-pane"
# Session switcher (requires tmux-sessionizer script)
bind -r Tab run-shell "tmux neww 'tmux-sessionizer'"

# Open opencode in new window/tab (smart - reuse existing window)
bind -r ` display-popup 'fish -c "$(fish -c history | fzf)"'
# Lazygit popup
bind -r t switch-client -T lazygit-table
bind -r -T lazygit-table g display-popup -d '#{pane_current_path}' -w 90% -h 90% -E 'lazygit'

# -- Copy Mode (Vi-style) -----------------------------------------------------
setw -g mode-keys vi

# Copy mode bindings
bind V copy-mode -u                   # Enter copy mode
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi Escape send -X cancel
bind -T copy-mode-vi c if -F '#{selection_present}' 'send -X clear-selection' 'send -X begin-selection'
bind -T copy-mode-vi y send -X copy-pipe-and-cancel "xclip -selection clipboard -in"

# Copy mode navigation
bind -T copy-mode-vi h send -N1 -X cursor-left
bind -T copy-mode-vi l send -N1 -X cursor-right
bind -T copy-mode-vi j send -N1 -X cursor-down
bind -T copy-mode-vi k send -N1 -X cursor-up

# Mouse wheel scrolling
bind -Tcopy-mode WheelUpPane send -N1 -X scroll-up
bind -Tcopy-mode WheelDownPane send -N1 -X scroll-down

# -- Theme and Appearance -----------------------------------------------------
# RGB 24-bit colour support
tmux_conf_24b_colour=auto

# Enable theming
tmux_conf_theme=enabled

# Color palette
tmux_conf_theme_colour_1="#080808"    # dark gray
tmux_conf_theme_colour_2="#303030"    # gray  
tmux_conf_theme_colour_3="#8a8a8a"    # light gray
tmux_conf_theme_colour_4="#00afff"    # light blue
tmux_conf_theme_colour_5="#ffff00"    # yellow
tmux_conf_theme_colour_6="#080808"    # dark gray
tmux_conf_theme_colour_7="#e4e4e4"    # white
tmux_conf_theme_colour_8="#080808"    # dark gray
tmux_conf_theme_colour_9="#ffff00"    # yellow
tmux_conf_theme_colour_10="#ff00af"   # pink
tmux_conf_theme_colour_11="#5fff00"   # green
tmux_conf_theme_colour_12="#8a8a8a"   # light gray
tmux_conf_theme_colour_13="#e4e4e4"   # white
tmux_conf_theme_colour_14="#080808"   # dark gray
tmux_conf_theme_colour_15="#080808"   # dark gray
tmux_conf_theme_colour_16="#d70000"   # red
tmux_conf_theme_colour_17="#e4e4e4"   # white

# Pane styling
tmux_conf_theme_window_fg="default"
tmux_conf_theme_window_bg="default"
tmux_conf_theme_highlight_focused_pane=false
tmux_conf_theme_focused_pane_bg="$tmux_conf_theme_colour_2"
tmux_conf_theme_pane_border_style=thin
tmux_conf_theme_pane_border="$tmux_conf_theme_colour_2"
tmux_conf_theme_pane_active_border="$tmux_conf_theme_colour_4"
set -g pane-active-border-style 'fg=magenta,bg=default'

# Status line content
tmux_conf_theme_status_left=" ❐ #S | ↑#{?uptime_y, #{uptime_y}y,}#{?uptime_d, #{uptime_d}d,}#{?uptime_h, #{uptime_h}h,}#{?uptime_m, #{uptime_m}m,} "
tmux_conf_theme_status_right=" #{prefix}#{mouse}#{?battery_bar, #{battery_bar},}#{?battery_percentage, #{battery_percentage},} , %R , %d %b | rauf322 "

# Status line styling  
tmux_conf_theme_status_fg="$tmux_conf_theme_colour_3"
tmux_conf_theme_status_bg="$tmux_conf_theme_colour_1"
tmux_conf_theme_status_attr="none"

# Window status styling
tmux_conf_theme_window_status_fg="$tmux_conf_theme_colour_3"
tmux_conf_theme_window_status_bg="$tmux_conf_theme_colour_1"
tmux_conf_theme_window_status_current_fg="$tmux_conf_theme_colour_1"
tmux_conf_theme_window_status_current_bg="$tmux_conf_theme_colour_4"
tmux_conf_theme_window_status_current_attr="bold"

# Powerline separators
tmux_conf_theme_left_separator_main='\uE0B0'
tmux_conf_theme_left_separator_sub='\uE0B1' 
tmux_conf_theme_right_separator_main='\uE0B2'
tmux_conf_theme_right_separator_sub='\uE0B3'

# Terminal title
tmux_conf_theme_terminal_title="#h ❐ #S ● #I #W"

# -- Plugin Settings (Optional) -----------------------------------------------
# Uncomment if you want to use plugins
# set -g @plugin 'nhdaly/tmux-better-mouse-mode'
# set -g @scroll-speed-num-lines-per-scroll 0.25

# Plugin management
tmux_conf_update_plugins_on_launch=false
tmux_conf_update_plugins_on_reload=false
tmux_conf_uninstall_plugins_on_reload=true
